<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Subtask Window</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" th:href="@{/style.css}">
</head>

<body class="subtask-page">

<header>
    <form th:action="@{/employees/{username}(username=${sessionUser})}">
        <button class="profile-button"><i class="fa fa-user-circle-o"></i></button>
    </form>
</header>

<main class="subtask-container">

    <div class="subtask-header-row">

        <div class="subtask-box large-box">
            <legend>
                <span th:text="${subtask.taskTitle} + ' — ' + ${subtask.taskStart} + ' / ' + ${subtask.taskEnd}"></span>

                <a th:if="${isManager}"
                   th:href="@{/projects/{pid}/tasks/{tid}/subtasks/{sid}/edit(pid=${pid}, tid=${tid}, sid=${sid})}"
                   class="edit-btn">Edit</a>
            </legend>

            <div class="content-area">
                <p th:text="${subtask.taskDescription}"></p>
            </div>
        </div>

        <div class="subtask-box small-box">
            <legend>
                People
                <a th:if="${isManager}"
                   th:href="@{/projects/{pid}/tasks/{tid}/subtasks/{sid}/assign-workers(pid=${pid}, tid=${tid}, sid=${sid})}"
                   class="small-add">Edit</a>
            </legend>

            <div class="content-area">
                <p th:if="${assignees.size() == 0}" class="empty-text">No workers assigned</p>

                <p th:each="a : ${assignees}">
                    <i class="fa fa-user"></i>
                    <span th:text="${a.employeeName}"></span>
                </p>
            </div>
        </div>

        <div class="subtask-box small-box">
            <legend>
                Dependencies
                <a th:if="${isManager}"
                   th:href="@{/projects/{pid}/tasks/{tid}/subtasks/{sid}/add-dependency(pid=${pid}, tid=${tid}, sid=${sid})}"
                   class="small-add">+</a>
            </legend>

            <div class="content-area">
                <p th:if="${dependencies.size() == 0}" class="empty-text">No dependencies</p>

                <p th:each="d : ${dependencies}"
                   th:text="${d.first()} + ' blocked by ' + ${d.second()}"></p>
            </div>
        </div>

    </div>

    <div class="subtask-middle-row">

        <div class="subtask-box medium-box">
            <legend>
                Artifacts
                <a th:if="${isManager}"
                   th:href="@{/projects/{pid}/tasks/{tid}/subtasks/{sid}/add-artifact(pid=${pid}, tid=${tid}, sid=${sid})}"
                   class="small-add">+</a>
            </legend>

            <div class="list-area">
                <p th:if="${artifacts.size() == 0}" class="empty-text">No artifacts</p>

                <p th:each="artifact : ${artifacts}"
                   th:text="${artifact.second()} + ' uploaded by ' + ${artifact.first()}"></p>
            </div>
        </div>

        <div class="subtask-box medium-box">
            <legend>
                Resources
                <a class="small-add">+</a>
            </legend>

            <div class="list-area">
                <p>
                    <i class="fa fa-user"></i>
                    <span th:text="${assignees.size()} + ' workers'"></span>
                </p>
            </div>
        </div>

    </div>

    <div class="subtask-comments-box">
        <legend>
            Comments
            <a class="small-add">+</a>
        </legend>

        <div class="content-area empty-block"></div>
    </div>

</main>

<footer>© 2025 Plannex</footer>

</body>
</html>
